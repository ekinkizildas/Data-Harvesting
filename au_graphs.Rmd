---
title: "VisAUlizations"
author: "Aurora Sterpellone"
date: "2025-03-18"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## libraries

```{r}
# Load necessary libraries
library(dplyr)
library(highcharter)

```


## Preparing the data

```{r}
# Assuming final_data is your dataset
# Group by movie title and summarize the data
grouped_data <- final_data %>%
  group_by(title) %>%
  summarise(
    movie_id = first(movie_id),
    release_year = first(release_year),
    popularity = mean(popularity, na.rm = TRUE),
    poster_path = first(poster_path),
    language = first(language),
    country = toString(unique(country)),  # Combine unique countries
    release_date = toString(unique(release_date)),  # Combine unique release dates
    academy_award = max(academy_award),
    academy_nominated = max(academy_nominated),
    palme_dor = max(palme_dor),
    golden_lion = max(golden_lion)
  ) %>%
  ungroup()

# Filter the top 10 most popular movies
top_10_movies <- grouped_data %>%
  arrange(desc(popularity)) %>%
  head(10)

```

## Awards Distribution

to show the distribution of different awards won by movies

```{r}
# Create a bar plot to show the distribution of different awards won by movies
awards_distribution <- top_10_movies %>%
  select(academy_award, academy_nominated, palme_dor, golden_lion) %>%
  summarise_all(sum) %>%
  pivot_longer(cols = everything(), names_to = "Award", values_to = "Count")

highchart() %>%
  hc_chart(type = 'column') %>%
  hc_xAxis(categories = awards_distribution$Award) %>%
  hc_add_series(name = "Awards Count", data = awards_distribution$Count) %>%
  hc_title(text = "Awards Distribution") %>%
  hc_subtitle(text = "Top 10 Most Popular Movies")

```


## Top Movies by Popularity

a bar plot to highlight the top 10 movies by popularity and show their awards

```{r}
# Create a bar plot to highlight the top 10 movies by popularity and show their awards
highchart() %>%
  hc_chart(type = 'column') %>%
  hc_xAxis(categories = top_10_movies$title) %>%
  hc_add_series(name = "Popularity", data = top_10_movies$popularity, color = "#dd1c77") %>%
  hc_add_series(name = "Academy Award", data = top_10_movies$academy_award, type = 'line', color = "darkgreen") %>%
  hc_add_series(name = "Academy Nominated", data = top_10_movies$academy_nominated, type = 'line', color = "#31a354") %>%
  hc_add_series(name = "Palme D'Or", data = top_10_movies$palme_dor, type = 'line', color = "#a1d99b") %>%
  hc_add_series(name = "Golden Lion", data = top_10_movies$golden_lion, type = 'line', color = "#e5f5e0") %>%
  hc_title(text = "Top Movies by Popularity and Awards") %>%
  hc_subtitle(text = "Highlighting Awards Won")

```


## Popularity by release year

[Line chart]
This chart will show how the average popularity of movies has changed over the years. It can help identify trends in movie popularity over time.

```{r}
# Calculate average popularity by release year
popularity_by_year <- grouped_data %>%
  group_by(release_year) %>%
  summarise(avg_popularity = mean(popularity, na.rm = TRUE))

# Create a line chart
highchart() %>%
  hc_chart(type = 'line') %>%
  hc_xAxis(title = list(text = "Release Year"), categories = popularity_by_year$release_year) %>%
  hc_add_series(name = "Average Popularity", data = popularity_by_year$avg_popularity, color = "#8856a7") %>%
  hc_title(text = "Average Movie Popularity by Release Year") %>%
  hc_subtitle(text = "Trends in Movie Popularity Over Time")


```

## Awards vs Popularity

[Bubble Chart]
This chart can show the relationship between the number of awards and the popularity of movies. The size of the bubbles can represent the total number of awards won.

```{r}
# Create a bubble chart
highchart() %>%
  hc_chart(type = 'bubble') %>%
  hc_xAxis(title = list(text = "Popularity")) %>%
  hc_yAxis(title = list(text = "Total Awards")) %>%
  hc_add_series(
    data = list_parse(top_10_movies %>% select(popularity, total_awards = academy_award + academy_nominated + palme_dor + golden_lion))
  ) %>%
  hc_title(text = "Awards vs Popularity") %>%
  hc_subtitle(text = "Bubble Size Represents Total Awards Won")

```

## Heatmap of Awards and Popularity -- not ok

[Heatmap]
This chart can show the intensity of awards and popularity across movies. It can help identify movies that are both highly popular and have won multiple awards

```{r}
# Create a heatmap
highchart() %>%
  hc_chart(type = 'heatmap') %>%
  hc_xAxis(categories = top_10_movies$title) %>%
  hc_yAxis(categories = c("Popularity", "Academy Award", "Academy Nominated", "Palme D'Or", "Golden Lion")) %>%
  hc_add_series(data = list_parse(top_10_movies %>% select(popularity, academy_award, academy_nominated, palme_dor, golden_lion))) %>%
  hc_title(text = "Heatmap of Awards and Popularity") %>%
  hc_subtitle(text = "Intensity of Awards and Popularity Across Movies")

```


## LANGUAGES -- not ok

```{r}
# Load necessary libraries
library(dplyr)
library(highcharter)
library(tidyr)

# Assuming final_data is your dataset
# Group by movie title and summarize the data
grouped_data <- final_data %>%
  group_by(title) %>%
  summarise(
    movie_id = first(movie_id),
    release_year = first(release_year),
    popularity = mean(popularity, na.rm = TRUE),
    poster_path = first(poster_path),
    language = toString(unique(language)),  # Combine unique languages
    country = toString(unique(country)),
    release_date = toString(unique(release_date)),
    academy_award = max(academy_award),
    academy_nominated = max(academy_nominated),
    palme_dor = max(palme_dor),
    golden_lion = max(golden_lion)
  ) %>%
  ungroup()

# Split the combined languages into individual languages
all_movies_languages <- grouped_data %>%
  mutate(language = strsplit(language, ", ")) %>%
  unnest(language)

# Count the number of movies for each language
language_count <- all_movies_languages %>%
  count(language, sort = TRUE)

# Create a bar chart to show the number of movies for each language
highchart() %>%
  hc_chart(type = 'column') %>%
  hc_xAxis(categories = language_count$language) %>%
  hc_add_series(name = "Number of Movies", data = language_count$n, color = "#dd1c77") %>%
  hc_title(text = "Number of Movies by Language") %>%
  hc_subtitle(text = "Distribution of Movies Across Languages")

```

